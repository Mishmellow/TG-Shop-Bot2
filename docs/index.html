<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegram WebApp Shop</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <script src="https://telegram.org/js/telegram-web-app.js"></script>

    <meta name="theme-color" content="var(--tg-theme-bg-color, #ffffff)">

<style>
    body {
    background-color: var(--tg-theme-bg-color, #ffffff);
    color: var(--tg-theme-text-color, #000000);
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    padding: 20px;
    text-align: center;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}
.main {
    max-width: 600px;
    margin: 0 auto;
}
.product-card {
    border: 1px solid var(--tg-theme-separator-color, #e0e0e0);
    padding: 15px;
    margin: 10px 0;
    border-radius: 8px;
    text-align: left;
}
.btn {
    background-color: var(--tg-theme-button-color, #2481cc);
    color: var(--tg-theme-button-text-color, #ffffff);
    border: none;
    padding: 10px 20px;
    border-radius: 5px;
    cursor: pointer;
    margin-top: 10px;
    display: block;
    width: 100%;
}
h2 {
    margin-top: 0;
    margin-bottom: 5px;
}
.price {
    margin: 0 0 10px 0;
    color: var(--tg-theme-hint-color, #999999);
}
</style>

</head>

<body>
    <div class="container text-center my-4">
        <h1 class="text-center mb-4">üõçÔ∏è –ö–æ—Ñ–µ</h1>

        <div class="row row-cols-1 row-cols-md-3 g-3">
            <div class="col">
                <div class="card h-100"> 
                    <img src="https://via.placeholder.com/286x180" class="card-img-top"
                        alt="Placeholder Image">
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title">–õ–∞—Ç—Ç–µ</h5>
                        <p class="card-text">–°–≤–µ–∂–µ—Å–≤–∞—Ä–µ–Ω–Ω—ã–π –∫–æ—Ñ–µ —Å –º–æ–ª–æ–∫–æ–º –∏ –ø–µ–Ω–∫–æ–π.</p>
                        <button class="btn btn-primary mt-auto add-to-cart-btn" 
                            data-product="latte" 
                            data-price="70" 
                            data-name="–õ–∞—Ç—Ç–µ">70 –≥—Ä–Ω</button>
                    </div>
                </div>
            </div>

        </div>
    </div>
    
    <div class="container text-center my-4">
        <h1 class="text-center mb-4">üçï –ü–∏—Ü—Ü–∞</h1>

        <div class="row row-cols-1 row-cols-md-3 g-3">

            <div class="col">
                <div class="card h-100"> 
                    <img src="https://via.placeholder.com/286x180" class="card-img-top"
                        alt="Placeholder Image">
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title">–ü–∏—Ü—Ü–∞ –ü–µ–ø–ø–µ—Ä–æ–Ω–∏</h5>
                        <p class="card-text">–û—Å—Ç—Ä–∞—è –ø–µ–ø–ø–µ—Ä–æ–Ω–∏ —Å —Ç–æ–º–∞—Ç–Ω—ã–º —Å–æ—É—Å–æ–º.</p>
                        <button class="btn btn-primary mt-auto add-to-cart-btn" 
                            data-product="pizza" 
                            data-price="120"
                            data-name="–ü–∏—Ü—Ü–∞ –ü–µ–ø–ø–µ—Ä–æ–Ω–∏">120 –≥—Ä–Ω</button>
                    </div>
                </div>
            </div>

        </div>
    </div>
    
    <div class="container text-center my-4">
        <h1 class="text-center mb-4">üçî –ë—É—Ä–≥–µ—Ä—ã</h1>

        <div class="row row-cols-1 row-cols-md-3 g-3">

            <div class="col">
                <div class="card h-100"> 
                    <img src="https://via.placeholder.com/286x180" class="card-img-top"
                        alt="Placeholder Image">
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title">–ë–æ–ª—å—à–æ–π –ë—É—Ä–≥–µ—Ä</h5>
                        <p class="card-text">–ú—è—Å–Ω–æ–π –±—É—Ä–≥–µ—Ä —Å –¥–≤–æ–π–Ω—ã–º —Å—ã—Ä–æ–º –∏ –±–µ–∫–æ–Ω–æ–º.</p>
                        <button class="btn btn-primary mt-auto add-to-cart-btn" 
                            data-product="burgers" 
                            data-price="250"
                            data-name="–ë–æ–ª—å—à–æ–π –ë—É—Ä–≥–µ—Ä">250 –≥—Ä–Ω</button>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>

    <script>
        const tg = window.Telegram.WebApp;
        let cart = [];

        function updateMainButton() {
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            const totalPrice = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            
            if (totalItems > 0) {
                // –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ: totalPrice –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∫–∞–∫ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ –≤ JS
                tg.MainButton.setText(`–û—Ñ–æ—Ä–º–∏—Ç—å –ó–∞–∫–∞–∑ (${totalPrice} –≥—Ä–Ω)`);
                tg.MainButton.show();
            } else {
                tg.MainButton.hide();
            }
        }

        function addToCart(productData) {
            // –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ price - —á–∏—Å–ª–æ, —Ö–æ—Ç—è –æ–Ω –ø—Ä–∏—Ö–æ–¥–∏—Ç –∫–∞–∫ —Å—Ç—Ä–æ–∫–∞ –∏–∑ data-price
            const price = parseInt(productData.price); 
            
            const existingItem = cart.find(item => item.product === productData.product);

            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({
                    product: productData.product,
                    name: productData.name,
                    price: price, // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ü–µ–Ω—É –∫–∞–∫ —á–∏—Å–ª–æ
                    quantity: 1
                });
            }
            
            updateMainButton();
            tg.HapticFeedback.notificationOccurred('success');
        }

        tg.ready();
        tg.expand();
        updateMainButton();

        document.querySelectorAll('.add-to-cart-btn').forEach(button => {
            button.addEventListener('click', () => {
                const product = button.getAttribute('data-product');
                // –í–∞–∂–Ω–æ: –ø–∞—Ä—Å–∏–º —Ü–µ–Ω—É –∫–∞–∫ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ
                const price = parseInt(button.getAttribute('data-price')); 
                const name = button.getAttribute('data-name');
                
                // –ü–µ—Ä–µ–¥–∞–µ–º —Ü–µ–Ω—É, –∏–º—è –∏ –ø—Ä–æ–¥—É–∫—Ç
                addToCart({ product, price, name });
            });
        });

        tg.MainButton.onClick(() => {
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ –∫–æ—Ä–∑–∏–Ω—ã
            const dataToSend = JSON.stringify({ items: cart });
            tg.sendData(dataToSend);
        });
    </script>
</body>

</html>